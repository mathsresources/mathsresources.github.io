condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
stripchart(list,
main=paste("Sample",list(data),", population median is",median,"and W =",wilcoxon_rank(data, eta = median)),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
stripchart(list,
main=paste("Sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
stripchart(list,
main=paste("Sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
stripchart(list,
main=paste("Sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
stripchart(list,
main=paste("sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
data <- c(6,8,8,2,10,11,15)
wilcoxon_rank(data, eta = 10)
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition=(data==median)
discard<-data[condition==TRUE]
use<-data[condition==FALSE]
list<-list("use"=use,"discard"=discard)
list<-list("use"=use,"discard"=discard)
stripchart(list,
main=paste("ranks assigned"),
method="stack",
pch=21,
col=c("black","black"),
bg=c("red","red"),
xaxt="n",
xlim=c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las=2)
abline(v=median)
ranks=rank(abs(use-median))
ranksign<-ifelse(use<median,-1,1)
signedranks<-ranks
text(use,1,signedranks,adj=c(0.5,-3),cex=0.7,col="black")
n<-6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max, n)
condition = (data == median)
discard <- data[condition == TRUE]
use <- data[condition == FALSE]
list <- list("use" = use, "discard" = discard)
stripchart(list,
main = paste("zeros discarded"),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5, x_max+0.5))
axis(1, at = seq(x_min, x_max, by = 1), las = 2)
abline(v = median)
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
stripchart(data,
main = paste("raw data"),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5, x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition=(data==median)
discard<-data[condition==TRUE]
use<-data[condition==FALSE]
list<-list("use"=use,"discard"=discard)
list<-list("use"=use,"discard"=discard)
stripchart(list,
main = paste("signed ranks"),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
head(W)
}
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
print(head(W))
}
wilcoxon_rank_simulation(100, 5, 6)
wilcoxon_rank_simulation(100, 5, 6)
wilcoxon_rank_simulation(100, 5, 6)
wilcoxon_rank_simulation(100, 5, 6)
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
print(W)
}
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
print(W)
}
wilcoxon_rank_simulation(100, 5, 6)
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
print(W)
}
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = 10))
barplot(table(W_data))
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = 10))
barplot(table(W_data))
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = 10))
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
barplot(table(W_data))
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = 10))
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
barplot(table(W_data))
replications <- 1000
sample_size <- 7
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
W_data <- replicate(replications,wilcoxon_rank_simulation(data, n = sample_size))
barplot(table(W_data))
sample_size = 10
check <- 8
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = sample_size))
table(W_data)
props <- proportions(table(W_data))
reds <- check + 1
greys <- sample_size * (sample_size + 1) * 0.5
vec_reds <- rep("red",times = reds)
vec_greys <- rep("blue", times = greys)
vec_col <- c(vec_reds, vec_greys)
upto <- check + 1
p <- sum(props[c(1:upto)])
barplot(props,
col = vec_col,
main = paste("W of",check,"or less appeared for",p,"of samples"))
sample_size = 10
check <- 8
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = sample_size))
props <- proportions(table(W_data))
reds <- check + 1
greys <- sample_size * (sample_size + 1) * 0.5
vec_reds <- rep("red",times = reds)
vec_greys <- rep("blue", times = greys)
vec_col <- c(vec_reds, vec_greys)
upto <- check + 1
p <- sum(props[c(1:upto)])
barplot(props,
col = vec_col,
main = paste("W of",check,"or less appeared for",p,"of samples"))
replications <- 1000
sample_size <- 7
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
W_data <- replicate(replications,wilcoxon_rank_simulation(data, n = sample_size))
barplot(table(W_data))
sample_size = 10
check <- 8
W_data <- replicate(10000,wilcoxon_rank_simulation(data, n = sample_size))
props <- proportions(table(W_data))
reds <- check + 1
greys <- sample_size * (sample_size + 1) * 0.5
vec_reds <- rep("red",times = reds)
vec_greys <- rep("blue", times = greys)
vec_col <- c(vec_reds, vec_greys)
upto <- check + 1
p <- sum(props[c(1:upto)])
barplot(props,
col = vec_col,
main = paste("W of",check,"or less appeared for",p,"of samples"))
replications <- 1000
sample_size <- 7
wilcoxon_rank_simulation <- function(data, eta = 0, n = 12)
{
data <- rnorm(n, mean = eta, sd = 4)
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
W_data <- replicate(replications,wilcoxon_rank_simulation(data, n = sample_size))
barplot(table(W_data))
data <- c(6,8,8,2,10,11,15)
wilcoxon_rank(data, eta = 10)
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
stripchart(list,
main=paste("sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition=(data==median)
discard<-data[condition==TRUE]
use<-data[condition==FALSE]
list<-list("use"=use,"discard"=discard)
list<-list("use"=use,"discard"=discard)
stripchart(list,
main = paste("signed ranks"),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
n <- 6
x_min <- 0
x_max <- 12
median <- 0.5*(x_max - x_min)
data <- sample(x_min:x_max,n)
condition = (data==median)
discard <- data[condition==TRUE]
use <- data[condition==FALSE]
list <- list("use"=use,"discard"=discard)
list <- list("use"=use,"discard"=discard)
wilcoxon_rank_silent <- function(data, eta = 0)
{
condition = (data == eta)
data_used <- data[condition == FALSE]
ranks <- rank(abs(data_used - eta))
rank_signs <- ifelse(data_used < eta, -1, 1)
signed_ranks <- ranks * rank_signs
W <- min(sum(signed_ranks[signed_ranks > 0]), (-1)*sum(signed_ranks[signed_ranks < 0]))
}
W<-wilcoxon_rank_silent(data, eta = median)
stripchart(list,
main=paste("sample",list(data),", population median is",median,"and W =",W),
method = "stack",
pch = 21,
col = c("black", "black"),
bg = c("red", "red"),
xaxt = "n",
xlim = c(x_min-0.5,x_max+0.5))
axis(1, at = seq(x_min,x_max, by = 1), las = 2)
abline(v = median)
ranks = rank(abs(use-median))
ranksign <- ifelse(use<median,"-","+")
signedranks <- paste(ranks, ranksign)
text(use, 1, signedranks, adj = c(0.5,-3), cex=0.7, col = "black")
install.packages("webexercises")
